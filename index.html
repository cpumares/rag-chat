<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<title> Chat con criterios DGSFP </title>
<style>
body{font-family:sans-serif;max-width:600px;margin:auto;padding:1rem}
#chat{border:1px solid #ccc;padding:.5rem;height:60vh;overflow-y:auto}
.msg{margin:.4rem 0}.user{color:#006cbb}.bot{color:#222}
input{width:100%;padding:.6rem;font-size:1rem}
</style>
</head>
<body>

<h2>Asistente RAG DGSFP</h2>
<div id="chat"></div>
<form id="form">
  <input id="txt" placeholder="Escribe tu pregunta sobre criterios DGSFP" autocomplete="off" />
</form>

<script>
const webhook ="https://antoniosautomationcentral.duckdns.org/webhook/ceb907d0-9012-4c5c-9b3d-90ee88761ba5";   // ← pon aquí la URL

const chat = document.getElementById("chat");
const txt  = document.getElementById("txt");

function add(text, cls){
  const div=document.createElement("div");
  div.className="msg "+cls;
  div.textContent=text;
  chat.appendChild(div);
  chat.scrollTop=chat.scrollHeight;
}

document.getElementById("form").addEventListener("submit", async e=>{
  e.preventDefault();
  const q = txt.value.trim();
  if(!q) return;
  add(q,"user");      // muestra mensaje del usuario
  txt.value="";

  try{
    const res = await fetch(webhook,{
      method:"POST",
      headers:{ "Content-Type":"application/json" },
      body:JSON.stringify({ question: q })
    });
    const data = await res.json();     // espera { answer:"..." }
    add(data.answer || "[sin respuesta]","bot");
  }catch(err){
    add("Error: "+err,"bot");
  }
});
</script>
</body>
</html>
